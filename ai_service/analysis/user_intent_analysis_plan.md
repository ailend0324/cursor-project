# 用户意图与诉求分析计划

基于现有的分析结果和 implementation_plan.md 的指导，我们将实施以下计划来深入分析用户意图和诉求，为FAQ系统做准备。

## 一、分析目标

- **识别用户意图**：从对话中提取用户的核心问题或需求
- **提取用户诉求**：明确用户期望通过客服交互实现的具体结果
- **为FAQ准备**：生成问题-意图-诉求-答案的结构化映射

## 二、分析步骤

### 1. 数据预处理增强
现有分析已经完成了基本的数据加载和清洗，但需要增强以下方面：

- **对话分组优化**：
  - 按`touch_id`将数据分组为完整对话
  - 保留对话顺序（`seq_no`）以分析对话流程
  
- **时间维度分析**：
  - 计算响应时间（客服回复用户的时间差）
  - 分析时间段分布（何时用户咨询最多）

- **用户消息分类优化**：
  - 增强`categorize_question`函数，加入更多行业特定关键词
  - 为关键词添加权重，提高分类准确率

### 2. 意图识别深化

根据现有FAQ分析结果（31.31%匹配率），我们需要建立更完善的意图识别系统：

- **增强关键词提取**：
  - 使用TF-IDF算法提取每个对话的关键词
  - 结合jieba分词优化中文关键词提取
  
- **意图分类体系**：
  基于现有FAQ分析结果，优化意图分类：
  - 回收流程（24.72%）
  - 人工服务（17.35%）
  - 价格咨询（17.19%）
  - 订单跟踪（14.63%）
  - 退回/取消（11.59%）
  - 其他类别（如第三方平台、设备状况等）

- **上下文意图理解**：
  - 分析同一对话中的多轮交互
  - 根据上下文修正单条消息的意图判断
  - 考虑转人工请求的上下文（提前转人工与多轮后转人工的差异）

### 3. 诉求提取方法

在识别意图基础上，进一步分析用户诉求：

- **情感分析**：
  - 使用SnowNLP分析用户消息情感倾向
  - 区分紧急诉求和一般咨询
  
- **诉求分类框架**：
  - 信息透明（如获取订单状态、价格明细）
  - 流程简化（如简化退货步骤）
  - 效率提升（如加快处理速度）
  - 信任保障（如数据安全、交易公平）
  - 服务改进（如优化沟通方式）

- **问题-诉求映射**：
  - 建立不同意图下的典型诉求模式
  - 例：价格咨询 → 透明定价、价格保证

### 4. 业务场景关联

将用户意图与业务场景相关联：

- **分析场景特有问题**：
  - 统计各业务场景（如上门回收、邮寄回收等）的高频意图
  - 识别场景特有的用户诉求

- **转人工场景分析**：
  - 深入分析转人工请求（15.85%的对话）
  - 了解用户为何需要人工服务，哪些问题AI无法解决

### 5. 满意度关联分析

如果数据中包含用户反馈信息（`new_feedback_name`）：

- **低满意度关联**：
  - 分析低满意度对话的用户意图和诉求
  - 识别服务痛点

- **高满意度借鉴**：
  - 提取高满意度对话的客服回复模式
  - 总结优秀话术和解决方案

### 6. FAQ结构化输出

将分析结果转化为完整的FAQ体系：

- **问题汇总**：
  - 按意图频率排序，优先处理高频问题
  - 覆盖各个业务场景的关键问题

- **答案设计**：
  - 为每个问题-意图-诉求组合设计标准答案
  - 加入自助服务信息和前瞻性解答

## 三、实施计划

### 第一阶段：分析增强（1周）
1. 增强现有 analyze_chat_data.py 中的分类功能
2. 实现关键词提取与TF-IDF算法
3. 开发上下文分析模块

### 第二阶段：诉求分析（1周）
1. 实现情感分析功能
2. 建立诉求分类系统
3. 分析业务场景与意图关联

### 第三阶段：FAQ开发（2周）
1. 整合意图-诉求分析结果
2. 设计FAQ问答库
3. 编写标准答案

### 第四阶段：测试与优化（1周）
1. 验证意图分类准确率
2. 用户测试FAQ效果
3. 持续优化模型

## 四、技术实现

### 基础分析增强
```python
def extract_keywords(text):
    """使用TF-IDF提取关键词"""
    words = jieba.cut(text)
    # TF-IDF实现
    return keywords

def analyze_conversation_context(messages):
    """分析对话上下文，提供完整意图判断"""
    # 实现对话上下文分析
    return context_intent
```

### 诉求分析
```python
from snownlp import SnowNLP

def analyze_sentiment(text):
    """分析文本情感倾向"""
    return SnowNLP(text).sentiments

def extract_user_demand(message, intent, sentiment):
    """基于意图和情感分析提取用户诉求"""
    # 根据不同意图和情感组合提取诉求
    return demand
```

### FAQ结构
```json
{
  "faqs": [
    {
      "question": "如何查询订单状态?",
      "intent": "订单跟踪",
      "demand": "快速获取信息",
      "answer": "您可以通过APP或网站查询订单状态，也可以提供订单号，我们将实时查询...",
      "scenarios": ["邮寄回收", "上门回收"]
    }
  ]
}
```

## 五、预期成果

1. **用户意图分析报告**：
   - 频率分布
   - 场景关联分析
   - 转人工原因分析

2. **用户诉求清单**：
   - 按意图分类的用户诉求
   - 诉求与满意度的关联

3. **FAQ知识库**：
   - 问题-意图-诉求-答案结构化数据
   - 覆盖90%以上的高频问题

4. **可视化分析**：
   - 意图分布图表
   - 诉求热力图
   - 场景-意图关联图

## 六、后续应用

1. **AI客服优化**：
   - 训练AI识别用户意图
   - 根据意图提供精准回复

2. **服务流程改进**：
   - 识别并解决服务痛点
   - 简化高频问题的处理流程

3. **知识库动态更新**：
   - 建立FAQ定期更新机制
   - 根据新数据调整问题优先级 